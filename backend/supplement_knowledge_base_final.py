import sqlite3
from datetime import datetime

def supplement_knowledge_base_final():
    conn = sqlite3.connect('vibe_chat.db')
    cursor = conn.cursor()
    
    new_scripts = []
    
    # ===========================================
    # 需求沟通话术（产品经理）- 深度扩展
    # ===========================================
    
    # 需求调研阶段
    new_scripts.append(('用户访谈准备', '各位，为了深入挖掘用户需求，我们需要进行用户访谈。访谈前需要准备：1. 明确访谈目标：[目标]，2. 准备访谈问题：[问题列表]，3. 安排访谈时间和地点，4. 准备录音设备和访谈记录表。请大家提前做好准备。', '准备用户访谈工作', 11, 3, '需求沟通', '专业', '同事', '用户访谈,准备工作', 1))
    
    new_scripts.append(('用户访谈执行', '在访谈过程中，请注意以下几点：1. 建立良好的沟通氛围，让用户放松，2. 用开放式问题引导用户，不要限制用户思维，3. 认真倾听，不要打断用户，4. 深入挖掘，多问"为什么"，5. 记录关键信息和用户原话。', '执行用户访谈的注意事项', 11, 3, '需求沟通', '专业', '同事', '用户访谈,执行技巧', 1))
    
    new_scripts.append(('用户访谈总结', '访谈结束后，需要整理访谈记录：1. 用户基本信息，2. 用户使用场景，3. 用户需求和痛点，4. 用户期望和建议，5. 用户原话摘录。请各位在[时间]前提交访谈记录，我汇总后进行分析。', '整理和总结用户访谈结果', 11, 3, '需求沟通', '专业', '同事', '用户访谈,总结', 1))
    
    new_scripts.append(('问卷设计', '关于用户需求问卷，我设计了以下内容：1. 基本信息：[信息项]，2. 使用习惯：[习惯项]，3. 需求偏好：[偏好项]，4. 满意度调查：[满意度项]，5. 开放性问题：[开放题]。请大家审阅一下，看看是否需要补充或调整。', '设计用户需求问卷', 11, 3, '需求沟通', '专业', '同事', '问卷设计,用户调研', 1))
    
    new_scripts.append(('数据分析沟通', '根据收集到的用户数据，我进行了以下分析：1. 用户画像：[画像描述]，2. 需求分布：[需求分布]，3. 痛点分析：[痛点分析]，4. 期望分析：[期望分析]。这些分析为产品规划提供了重要依据。', '与团队分享用户数据分析结果', 11, 3, '需求沟通', '专业', '同事', '数据分析,用户研究', 1))
    
    # 需求定义阶段
    new_scripts.append(('用户故事编写', '编写用户故事时，请遵循以下格式：作为[用户角色]，我希望[功能描述]，以便[价值描述]。每个用户故事要包含验收标准：1. [验收条件1]，2. [验收条件2]，3. [验收条件3]。请大家按照这个格式编写。', '规范用户故事的编写格式', 11, 3, '需求沟通', '专业', '同事', '用户故事,需求编写', 1))
    
    new_scripts.append(('需求优先级评估', '基于MoSCoW方法，我们将需求分为：1. Must have（必须有）：[需求列表]，2. Should have（应该有）：[需求列表]，3. Could have（可以有）：[需求列表]，4. Won\'t have（这次不做）：[需求列表]。请大家按照这个优先级执行。', '使用MoSCoW方法评估需求优先级', 11, 3, '需求沟通', '专业', '同事', '需求优先级,MoSCoW', 1))
    
    new_scripts.append(('需求矩阵', '我制作了需求-价值矩阵，横轴是实施成本，纵轴是用户价值。根据矩阵分析：1. 高价值低成本（优先实施）：[需求列表]，2. 高价值高成本（重点规划）：[需求列表]，3. 低价值低成本（考虑实施）：[需求列表]，4. 低价值高成本（暂不实施）：[需求列表]。', '使用需求-价值矩阵分析需求', 11, 3, '需求沟通', '专业', '同事', '需求矩阵,价值分析', 1))
    
    new_scripts.append(('PRD文档评审', '各位，PRD文档已经编写完成，包含以下章节：1. 产品概述，2. 用户角色和场景，3. 功能需求详细说明，4. 非功能需求（性能、安全、兼容性等），5. 数据流程图，6. 页面原型。请大家仔细审阅，提出修改意见。', '评审产品需求文档', 11, 3, '需求沟通', '专业', '同事', 'PRD文档,评审', 1))
    
    # 需求确认阶段
    new_scripts.append(('需求确认会', '各位，今天召开需求确认会。会议目标是：1. 确认需求的完整性和准确性，2. 明确需求的边界和范围，3. 确认需求的优先级和排期，4. 识别潜在风险和依赖关系。请大家积极参与讨论。', '组织需求确认会议', 11, 3, '需求沟通', '专业', '同事', '需求确认,会议', 1))
    
    new_scripts.append(('需求签字确认', '经过讨论，我们达成以下共识：1. 需求范围：[范围描述]，2. 功能列表：[功能列表]，3. 非功能需求：[需求列表]，4. 验收标准：[标准列表]。请大家签字确认，作为后续开发的依据。', '签署需求确认文档', 11, 3, '需求沟通', '专业', '同事', '需求确认,签字', 1))
    
    new_scripts.append(('需求基线管理', '本次确认的需求将作为需求基线。后续如需变更，需要走正式的变更流程：1. 提出变更申请，2. 评估变更影响，3. 获得审批，4. 更新需求文档，5. 通知相关方。请大家严格执行变更流程。', '说明需求基线和变更流程', 11, 3, '需求沟通', '专业', '同事', '需求基线,变更管理', 1))
    
    # ===========================================
    # 项目推进话术（项目经理）- 深度扩展
    # ===========================================
    
    # 项目启动阶段
    new_scripts.append(('项目章程沟通', '各位，项目章程已经制定完成。项目章程包含：1. 项目背景和目标，2. 项目范围和交付物，3. 关键干系人，4. 项目组织架构，5. 项目里程碑和时间表，6. 项目预算和资源，7. 项目风险和假设。请大家认真阅读并签字确认。', '沟通项目章程内容', 6, 2, '项目推进', '专业', '同事', '项目章程,启动', 1))
    
    new_scripts.append(('干系人沟通', '项目的关键干系人包括：1. 发起人：[姓名]，2. 项目经理：[姓名]，3. 团队成员：[名单]，4. 业务方：[名单]，5. 用户代表：[名单]。我会定期与各位干系人沟通，确保项目信息同步。', '识别并沟通项目干系人', 6, 2, '项目推进', '专业', '同事', '干系人,识别沟通', 1))
    
    new_scripts.append(('项目沟通计划', '为了确保项目信息及时传递，我制定了沟通计划：1. 日报：团队成员每日提交工作日报，2. 周会：每周五召开项目周会，3. 月报：每月向领导提交项目月报，4. 里程碑评审：每个里程碑召开评审会。请大家按计划执行。', '制定项目沟通计划', 6, 2, '项目推进', '专业', '同事', '沟通计划,制定', 1))
    
    # 项目规划阶段
    new_scripts.append(('WBS工作分解', '为了更好地管理项目，我进行了WBS工作分解：1. 一级分解：[一级任务]，2. 二级分解：[二级任务]，3. 三级分解：[三级任务]。每个工作包都明确了负责人、时间和交付物。请大家按照WBS执行工作。', '进行工作分解结构(WBS)分解', 6, 2, '项目推进', '专业', '同事', 'WBS,工作分解', 1))
    
    new_scripts.append(('甘特图规划', '我制作了项目甘特图，展示了项目的进度计划：1. 任务的开始和结束时间，2. 任务之间的依赖关系，3. 关键路径：[任务列表]，4. 里程碑节点：[里程碑列表]。甘特图已分享，请大家参考。', '使用甘特图规划项目进度', 6, 2, '项目推进', '专业', '同事', '甘特图,进度规划', 1))
    
    new_scripts.append(('资源平衡', '在项目规划过程中，我发现资源存在冲突：[冲突描述]。我进行了资源平衡：1. 调整了任务的开始时间，2. 增加了资源投入，3. 优化了资源分配。平衡后的资源利用率是[利用率]，可以满足项目需求。', '平衡项目资源分配', 6, 2, '项目推进', '专业', '同事', '资源平衡,分配', 1))
    
    new_scripts.append(('项目预算制定', '根据项目范围和资源需求，我制定了项目预算：1. 人力成本：[金额]，2. 设备成本：[金额]，3. 外包成本：[金额]，4. 其他成本：[金额]，5. 应急储备：[金额]。总预算：[总金额]。预算已审批，请大家按预算执行。', '制定项目预算', 6, 2, '项目推进', '专业', '同事', '项目预算,制定', 1))
    
    # 项目执行阶段
    new_scripts.append(('团队建设', '为了提高团队凝聚力和执行力，我计划开展以下团队建设活动：1. 定期团建活动，2. 技能培训和分享，3. 团队会议和沟通，4. 表彰和激励机制。希望大家积极参与，共同建设高效的团队。', '开展团队建设活动', 6, 2, '项目推进', '积极', '同事', '团队建设,凝聚力', 1))
    
    new_scripts.append(('任务执行监控', '我正在监控任务的执行情况：1. 已完成任务：[任务列表]，2. 进行中任务：[任务列表]，3. 延期任务：[任务列表]。对于延期任务，我已与负责人沟通，制定了赶工计划。请大家关注自己的任务进度。', '监控任务执行情况', 8, 2, '进度同步', '专业', '同事', '任务执行,监控', 1))
    
    new_scripts.append(('质量保证', '为了保证项目质量，我制定了质量保证计划：1. 代码审查：定期进行代码审查，2. 单元测试：开发人员编写单元测试，3. 集成测试：定期进行集成测试，4. 系统测试：测试团队进行全面测试。请大家严格执行质量保证措施。', '制定和执行质量保证计划', 8, 2, '进度同步', '专业', '同事', '质量保证,计划', 1))
    
    new_scripts.append(('变更控制', '项目执行过程中，如果需要变更，请按以下流程执行：1. 提出变更申请，2. 评估变更影响（范围、进度、成本、质量），3. 获得变更审批，4. 实施变更，5. 验证变更结果。请大家严格按照变更控制流程执行。', '执行项目变更控制流程', 13, 3, '需求变更', '专业', '同事', '变更控制,流程', 1))
    
    # 项目监控阶段
    new_scripts.append(('挣值分析', '根据挣值分析，项目的绩效如下：1. 计划价值(PV)：[金额]，2. 挣值(EV)：[金额]，3. 实际成本(AC)：[金额]，4. 进度偏差(SV)：[金额]，5. 成本偏差(CV)：[金额]，6. 进度绩效指数(SPI)：[数值]，7. 成本绩效指数(CPI)：[数值]。项目进度[超前/滞后]，成本[节约/超支]。', '进行挣值分析评估项目绩效', 8, 2, '进度同步', '专业', '同事', '挣值分析,绩效评估', 1))
    
    new_scripts.append(('风险监控', '我正在持续监控项目风险：1. 已识别风险：[风险列表]，2. 新识别风险：[风险列表]，3. 已发生风险：[风险列表]，4. 已缓解风险：[风险列表]。请大家关注风险变化，及时报告新风险。', '监控项目风险状态', 9, 2, '风险同步', '专业', '同事', '风险监控,状态跟踪', 1))
    
    new_scripts.append(('项目审计', '为了确保项目符合规范，我计划进行项目审计：1. 审计范围：[审计内容]，2. 审计时间：[时间]，3. 审计人员：[人员]，4. 审计标准：[标准]。请大家提前准备好相关文档和记录。', '组织项目审计', 8, 2, '进度同步', '专业', '同事', '项目审计,合规', 1))
    
    # 项目收尾阶段
    new_scripts.append(('项目验收准备', '项目即将完成，我正在准备验收材料：1. 交付物清单：[清单]，2. 测试报告：[报告]，3. 用户手册：[手册]，4. 技术文档：[文档]，5. 培训材料：[材料]。请各位完善自己的交付物，确保质量。', '准备项目验收材料', 10, 2, '向上汇报', '专业', '同事', '项目验收,准备', 1))
    
    new_scripts.append(('项目验收会', '各位，今天召开项目验收会。会议议程：1. 项目成果汇报，2. 交付物演示，3. 用户反馈，4. 问题讨论，5. 验收结论。请大家准备好演示和说明。', '组织项目验收会议', 10, 2, '向上汇报', '专业', '同事', '项目验收,会议', 1))
    
    new_scripts.append(('项目总结', '项目已经圆满完成，我来总结一下：1. 项目成果：[成果]，2. 关键成功因素：[因素]，3. 遇到的挑战和解决方案：[挑战和方案]，4. 经验教训：[经验]，5. 改进建议：[建议]。感谢大家的辛勤付出！', '总结项目成果和经验', 10, 2, '向上汇报', '积极', '同事', '项目总结,经验教训', 1))
    
    new_scripts.append(('项目归档', '项目完成后，需要进行归档：1. 项目文档：[文档列表]，2. 代码和配置：[代码仓库]，3. 测试数据：[数据文件]，4. 会议记录：[记录列表]。请各位在[时间]前完成归档工作。', '进行项目归档', 10, 2, '向上汇报', '专业', '同事', '项目归档,文档管理', 1))
    
    # ===========================================
    # Bug处理话术（测试工程师）- 深度扩展
    # ===========================================
    
    # 测试策略
    new_scripts.append(('测试策略制定', '为了确保产品质量，我制定了测试策略：1. 测试类型：[类型列表]，2. 测试范围：[范围描述]，3. 测试工具：[工具列表]，4. 测试环境：[环境描述]，5. 测试资源：[资源分配]，6. 测试进度：[时间计划]。请大家按照测试策略执行。', '制定项目测试策略', 26, 7, 'Bug反馈', '专业', '同事', '测试策略,制定', 1))
    
    new_scripts.append(('测试用例设计', '测试用例设计需要包含以下要素：1. 用例编号，2. 用例标题，3. 前置条件，4. 测试步骤，5. 预期结果，6. 实际结果，7. 测试数据，8. 优先级。请大家按照这个格式设计测试用例。', '规范测试用例的设计格式', 26, 7, 'Bug反馈', '专业', '同事', '测试用例,设计', 1))
    
    new_scripts.append(('测试用例评审', '各位，测试用例已经设计完成，共[数量]个用例。主要覆盖：1. 功能测试：[用例数]个，2. 性能测试：[用例数]个，3. 安全测试：[用例数]个，4. 兼容性测试：[用例数]个。请大家评审一下，看是否需要补充或调整。', '评审测试用例', 26, 7, 'Bug反馈', '专业', '同事', '测试用例,评审', 1))
    
    new_scripts.append(('测试环境搭建', '测试环境已经搭建完成，包含：1. 测试服务器：[配置]，2. 测试数据库：[数据]，3. 测试网络：[网络配置]，4. 测试工具：[工具版本]。请大家确认环境是否满足测试需求，有问题及时反馈。', '搭建测试环境', 26, 7, 'Bug反馈', '专业', '同事', '测试环境,搭建', 1))
    
    new_scripts.append(('测试数据准备', '为了进行全面测试，我准备了测试数据：1. 正常数据：[数据描述]，2. 边界数据：[数据描述]，3. 异常数据：[数据描述]，4. 性能测试数据：[数据描述]。测试数据已导入数据库，请大家确认。', '准备测试数据', 26, 7, 'Bug反馈', '专业', '同事', '测试数据,准备', 1))
    
    # 测试执行
    new_scripts.append(('测试执行计划', '测试执行计划如下：1. 测试阶段：[阶段列表]，2. 每个阶段的测试类型：[类型]，3. 测试用例分配：[分配方案]，4. 测试时间：[时间计划]，5. 测试负责人：[人员]。请大家按计划执行测试。', '制定测试执行计划', 26, 7, 'Bug反馈', '专业', '同事', '测试执行,计划', 1))
    
    new_scripts.append(('冒烟测试', '在正式测试前，我们需要进行冒烟测试，验证核心功能是否可用。冒烟测试包括：1. [功能1]，2. [功能2]，3. [功能3]。如果冒烟测试通过，我们才能进入正式测试阶段。', '执行冒烟测试', 26, 7, 'Bug反馈', '专业', '同事', '冒烟测试,执行', 1))
    
    new_scripts.append(('回归测试', '每次代码更新后，都需要进行回归测试，确保新代码没有破坏原有功能。回归测试包括：1. 核心功能测试，2. 上次修复的Bug测试，3. 相关功能测试。请测试团队按计划执行回归测试。', '执行回归测试', 26, 7, 'Bug反馈', '专业', '同事', '回归测试,执行', 1))
    
    new_scripts.append(('性能测试', '性能测试计划如下：1. 测试场景：[场景列表]，2. 并发用户数：[用户数]，3. 响应时间要求：[时间]，4. 吞吐量要求：[吞吐量]。测试工具：[工具名称]。测试时间：[时间]。请大家准备好。', '执行性能测试', 26, 7, 'Bug反馈', '专业', '同事', '性能测试,执行', 1))
    
    new_scripts.append(('安全测试', '安全测试包括以下内容：1. 漏洞扫描：使用[工具名称]，2. 渗透测试：由[人员]执行，3. 代码审计：由[人员]执行，4. 安全合规检查：检查[合规要求]。测试结果将汇总成安全测试报告。', '执行安全测试', 26, 7, 'Bug反馈', '专业', '同事', '安全测试,执行', 1))
    
    # 测试报告
    new_scripts.append(('测试日报', '今天的测试情况如下：1. 执行用例数：[数量]个，2. 通过用例数：[数量]个，3. 失败用例数：[数量]个，4. 发现Bug数：[数量]个，5. 严重Bug数：[数量]个。详细的Bug列表和测试用例执行情况已发送，请查收。', '生成测试日报', 26, 7, 'Bug反馈', '专业', '同事', '测试日报,生成', 1))
    
    new_scripts.append(('测试周报', '本周测试情况如下：1. 测试用例执行率：[百分比]，2. 测试用例通过率：[百分比]，3. Bug发现数：[数量]个，4. Bug修复数：[数量]个，5. Bug关闭数：[数量]个。下周计划：[下周计划]。需要重点关注：[重点关注事项]。', '生成测试周报', 26, 7, 'Bug反馈', '专业', '同事', '测试周报,生成', 1))
    
    new_scripts.append(('测试总结报告', '测试总结报告内容如下：1. 测试概况：[概况]，2. 测试范围：[范围]，3. 测试用例统计：[统计]，4. Bug统计和分析：[分析]，5. 测试结论：[结论]，6. 风险和建议：[风险和建议]。详细的测试报告已发送，请查收。', '生成测试总结报告', 26, 7, 'Bug反馈', '专业', '同事', '测试总结,报告', 1))
    
    # ===========================================
    # 客户对接话术（售前人员）- 深度扩展
    # ===========================================
    
    # 客户开发
    new_scripts.append(('潜在客户开发', '为了开发新客户，我制定了以下计划：1. 目标客户分析：[分析结果]，2. 客户触达渠道：[渠道列表]，3. 客户沟通策略：[策略]，4. 客户跟进计划：[计划]。预计本月可以开发[数量]个新客户。', '制定新客户开发计划', 1, 1, '客户对接', '专业', '同事', '客户开发,计划', 1))
    
    new_scripts.append(('陌生拜访话术', '您好！我是[公司名称]的[职位]。我们专注于[领域]，为[客户类型]提供[服务内容]。今天冒昧拜访，是想向您介绍一下我们的产品，看看是否能帮助您解决一些问题。方便吗？', '陌生拜访的开场话术', 1, 1, '客户对接', '温和', '客户', '陌生拜访,开场', 1))
    
    new_scripts.append(('电话营销话术', '[客户姓名]您好！我是[公司名称]的[姓名]。我们公司专注于[领域]，最近推出了[新产品/服务]，我觉得对贵公司很有价值。不知道您是否有时间了解一下呢？只需要占用您5分钟时间。', '电话营销的话术', 1, 1, '客户对接', '温和', '客户', '电话营销,话术', 1))
    
    new_scripts.append(('邮件营销话术', '[客户姓名]您好！我是[公司名称]的[姓名]。我们公司专注于[领域]，为[客户类型]提供[服务内容]。最近我们推出了[新产品/服务]，我认为对贵公司很有价值。如果您感兴趣，可以回复邮件或致电[电话]，我详细介绍。', '邮件营销的话术', 1, 1, '客户对接', '专业', '客户', '邮件营销,话术', 1))
    
    new_scripts.append(('客户转化', '经过前期的沟通和跟进，[客户姓名]已经表现出明确的购买意向。我计划在本周进行最后冲刺：1. 解决客户的最后疑虑，2. 提供优惠方案，3. 协助客户完成内部审批，4. 推进签约流程。', '推进客户的最终转化', 1, 1, '客户对接', '积极', '客户', '客户转化,签约', 1))
    
    # 客户关系管理
    new_scripts.append(('客户分层管理', '根据客户的价值和潜力，我将客户分为以下层级：1. VIP客户：[客户列表]，2. 重要客户：[客户列表]，3. 普通客户：[客户列表]。对不同层级的客户，我们会提供差异化的服务和支持。', '对客户进行分层管理', 1, 1, '客户对接', '专业', '同事', '客户分层,管理', 1))
    
    new_scripts.append(('客户满意度调查', '为了了解客户对我们服务的满意度，我计划进行客户满意度调查。调查内容包括：1. 产品满意度，2. 服务满意度，3. 价格满意度，4. 推荐意愿。调查方式：[调查方式]。请大家配合完成。', '进行客户满意度调查', 1, 1, '客户对接', '专业', '客户', '客户满意度,调查', 1))
    
    new_scripts.append(('客户流失预警', '根据客户行为分析，[客户姓名]可能存在流失风险：1. 使用频率下降：[数据]，2. 投诉增加：[数据]，3. 竞品接触：[信息]。我计划采取以下挽回措施：1. 主动沟通，2. 提供优惠，3. 改进服务。', '预警和挽回流失客户', 1, 1, '客户对接', '紧急', '同事', '客户流失,预警挽回', 1))
    
    new_scripts.append(('客户推荐计划', '为了扩大客户基础，我计划启动客户推荐计划：1. 推荐奖励：[奖励方案]，2. 推荐流程：[流程说明]，3. 推荐工具：[工具列表]。请大家积极参与，推荐更多优质客户。', '启动客户推荐计划', 1, 1, '客户对接', '积极', '同事', '客户推荐,计划', 1))
    
    # 客户价值挖掘
    new_scripts.append(('客户需求挖掘', '为了更好地满足客户需求，我计划深入挖掘客户需求：1. 客户访谈：[访谈计划]，2. 数据分析：[分析内容]，3. 市场调研：[调研内容]。挖掘结果将用于产品优化和新功能开发。', '深入挖掘客户需求', 2, 1, '需求咨询', '专业', '同事', '客户需求,挖掘', 1))
    
    new_scripts.append(('交叉销售话术', '[客户姓名]您好！您已经使用了我们的[产品A]。根据您的使用情况，我觉得我们的[产品B]也非常适合您。它可以帮助您[价值描述]。如果您感兴趣，我可以给您详细介绍。', '向客户进行交叉销售', 1, 1, '客户对接', '温和', '客户', '交叉销售,话术', 1))
    
    new_scripts.append(('增销话术', '[客户姓名]您好！关于您购买的[产品/服务]，我建议您可以升级到[高级版本]。高级版本相比基础版本，有以下优势：1. [优势1]，2. [优势2]，3. [优势3]。升级费用只增加[金额]，性价比很高。', '向客户进行增销', 1, 1, '客户对接', '温和', '客户', '增销,话术', 1))
    
    new_scripts.append(('客户成功案例', '[客户姓名]您好！我想分享一个成功案例给您。[案例客户]使用我们的产品后，取得了[成果]。他们遇到的问题和您很相似，所以我觉得这个案例对您很有参考价值。如果您需要更详细的信息，我可以发送案例报告。', '分享客户成功案例', 3, 1, '方案讲解', '积极', '客户', '成功案例,分享', 1))
    
    # 插入新话术
    cursor.executemany('''
        INSERT INTO scripts (title, content, brief_content, category_id, position_id, scene_type, tone, target_audience, tags, is_free)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
    ''', new_scripts)
    
    conn.commit()
    
    print('知识库最终补充完成！')
    print(f'新增话术数量: {len(new_scripts)}条')
    print(f'总话术数量: {cursor.execute("SELECT COUNT(*) FROM scripts").fetchone()[0]}条')
    
    # 计算总字数
    total_words = 0
    scripts = cursor.execute('SELECT content FROM scripts').fetchall()
    for script in scripts:
        total_words += len(script[0])
    
    print(f'知识库总字数: {total_words}字')
    
    conn.close()

if __name__ == '__main__':
    supplement_knowledge_base_final()
